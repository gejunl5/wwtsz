<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>窝窝头是猪</title>
<style>
  html, body {
    margin: 0; padding: 0; overflow: hidden;
    height: 100vh;
    background: #111;
    user-select: none;
  }
  #text {
    position: absolute;
    font-size: 80px;
    font-weight: bold;
    color: #fff;
    pointer-events: none;
    will-change: transform;
  }
  #trailCanvas {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    pointer-events: none;
    z-index: 0;
  }
</style>
</head>
<body>
<canvas id="trailCanvas"></canvas>
<div id="text">窝窝头是猪</div>

<script>
  const text = document.getElementById('text');
  const canvas = document.getElementById('trailCanvas');
  const ctx = canvas.getContext('2d');

  let vw = window.innerWidth;
  let vh = window.innerHeight;
  canvas.width = vw;
  canvas.height = vh;

  // 文字大小估算（用80px字体）
  const textWidth = 320; // 大约估算
  const textHeight = 90;

  let x = Math.random() * (vw - textWidth);
  let y = Math.random() * (vh - textHeight);
  let vx = 4 + Math.random() * 3;
  let vy = 3 + Math.random() * 3;

  let angle = 0;
  let angularVelocity = 0.05 + Math.random() * 0.05;

  let flashTime = 0;
  const trail = [];

  // 颜色变换函数，返回彩虹色rgb字符串
  function rainbowColor(t) {
    const r = Math.floor(127 * (Math.sin(t) + 1));
    const g = Math.floor(127 * (Math.sin(t + 2) + 1));
    const b = Math.floor(127 * (Math.sin(t + 4) + 1));
    return `rgb(${r},${g},${b})`;
  }

  function loop() {
    x += vx;
    y += vy;

    if (x < 0) {
      x = 0;
      vx = -vx;
    } else if (x + textWidth > vw) {
      x = vw - textWidth;
      vx = -vx;
    }
    if (y < 0) {
      y = 0;
      vy = -vy;
    } else if (y + textHeight > vh) {
      y = vh - textHeight;
      vy = -vy;
    }

    angle += angularVelocity;
    if (angle > Math.PI * 2) angle -= Math.PI * 2;

    flashTime += 0.1;
    const flashAlpha = 0.5 + 0.5 * Math.sin(flashTime * 10);

    // 主颜色和拖影颜色用时间算彩虹色
    const mainColor = rainbowColor(flashTime * 5);

    trail.push({x, y, angle, alpha: flashAlpha, color: mainColor});
    if (trail.length > 20) trail.shift();

    ctx.clearRect(0, 0, vw, vh);
    for (let i = 0; i < trail.length; i++) {
      const t = trail[i];
      ctx.save();
      ctx.translate(t.x + textWidth / 2, t.y + textHeight / 2);
      ctx.rotate(t.angle);
      ctx.globalAlpha = t.alpha * (i / trail.length) * 0.5;
      ctx.fillStyle = t.color;
      ctx.font = 'bold 80px sans-serif';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText('窝窝头是猪', 0, 0);
      ctx.restore();
    }

    text.style.left = x + 'px';
    text.style.top = y + 'px';
    text.style.transform = `rotate(${angle}rad)`;
    text.style.color = mainColor;
    text.style.opacity = flashAlpha;

    requestAnimationFrame(loop);
  }

  window.addEventListener('resize', () => {
    vw = window.innerWidth;
    vh = window.innerHeight;
    canvas.width = vw;
    canvas.height = vh;
  });

  loop();
</script>
</body>
</html>
